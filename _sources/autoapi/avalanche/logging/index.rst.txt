:mod:`avalanche.logging`
========================

.. py:module:: avalanche.logging

.. autoapi-nested-parse::

   The :py:mod:`logging` module provides a set of utilities that can be used for
   logging your experiment metrics results  on stdout, logfile and browser-based
   dashboard such as "Tensorboard" and "Weights & Biases". These resources are
   provided in :py:mod:`interactive_logging`, :py:mod:`text_logging` and
   :py:mod:`tensorboard_logger` respectively. Loggers do not specify
   which metrics to monitor, but only the way metrics will be reported
   to the user. Please, see :py:mod:`evaluation` module for a list of
   metrics and how to use them.
   Loggers should be passed as parameters to the `EvaluationPlugin`
   in order to properly monitor the training and evaluation flows.



Submodules
----------
.. toctree::
   :titlesonly:
   :maxdepth: 1

   interactive_logging/index.rst
   strategy_logger/index.rst
   tensorboard_logger/index.rst
   text_logging/index.rst
   wandb_logger/index.rst


Package Contents
----------------

Classes
~~~~~~~

.. autoapisummary::

   avalanche.logging.StrategyLogger
   avalanche.logging.TensorboardLogger
   avalanche.logging.WandBLogger
   avalanche.logging.TextLogger



.. py:class:: StrategyLogger

   Bases: :class:`StrategyCallbacks[None]`, :class:`abc.ABC`

   The base class for the strategy loggers.

   Strategy loggers will receive events, under the form of callback calls,
   from the :class:`EvaluationPlugin` carrying a reference to the strategy
   as well as the values emitted by the metrics.

   Each child class should implement the `log_metric` method, which
   specifies how to report to the user the metrics gathered during
   training and evaluation flows. The `log_metric` method is invoked
   by default on each callback.
   In addition, child classes may override the desired callbacks
   to customize the logger behavior.

   Make sure, when overriding callbacks, to call
   the proper `super` method.

   Initialize self.  See help(type(self)) for accurate signature.

   .. method:: log_metric(self, metric_value: MetricValue, callback: str) -> None

      This abstract method will has to be implemented by child classes.
      This method will be invoked on each callback.
      The `callback` parameter describes the callback from which the metric
      value is coming from.

      :param metric_value: The value to be logged.
      :param callback: The name of the callback (event) from which the
          metric value was obtained.
      :return: None


   .. method:: before_training(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `train` by the `BaseStrategy`. 


   .. method:: before_training_exp(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `train_exp` by the `BaseStrategy`. 


   .. method:: after_train_dataset_adaptation(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `train_dataset_adapatation` by the `BaseStrategy`. 


   .. method:: before_training_epoch(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `train_epoch` by the `BaseStrategy`. 


   .. method:: before_training_iteration(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before the start of a training iteration by the
      `BaseStrategy`. 


   .. method:: before_forward(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `model.forward()` by the `BaseStrategy`. 


   .. method:: after_forward(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `model.forward()` by the `BaseStrategy`. 


   .. method:: before_backward(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `criterion.backward()` by the `BaseStrategy`. 


   .. method:: after_backward(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `criterion.backward()` by the `BaseStrategy`. 


   .. method:: after_training_iteration(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after the end of a training iteration by the
      `BaseStrategy`. 


   .. method:: before_update(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `optimizer.update()` by the `BaseStrategy`. 


   .. method:: after_update(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `optimizer.update()` by the `BaseStrategy`. 


   .. method:: after_training_epoch(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `train_epoch` by the `BaseStrategy`. 


   .. method:: after_training_exp(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `train_exp` by the `BaseStrategy`. 


   .. method:: after_training(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `train` by the `BaseStrategy`. 


   .. method:: before_eval(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `eval` by the `BaseStrategy`. 


   .. method:: after_eval_dataset_adaptation(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `eval_dataset_adaptation` by the `BaseStrategy`. 


   .. method:: before_eval_exp(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `eval_exp` by the `BaseStrategy`. 


   .. method:: after_eval_exp(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `eval_exp` by the `BaseStrategy`. 


   .. method:: after_eval(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `eval` by the `BaseStrategy`. 


   .. method:: before_eval_iteration(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before the start of a training iteration by the
      `BaseStrategy`. 


   .. method:: before_eval_forward(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `model.forward()` by the `BaseStrategy`. 


   .. method:: after_eval_forward(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `model.forward()` by the `BaseStrategy`. 


   .. method:: after_eval_iteration(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after the end of an iteration by the
      `BaseStrategy`. 



.. py:class:: TensorboardLogger(tb_log_dir='./tb_data', filename_suffix='')

   Bases: :class:`avalanche.logging.StrategyLogger`

   The `TensorboardLogger` provides an easy integration with
   Tensorboard logging. Each monitored metric is automatically
   logged to Tensorboard.
   The user can inspect results in real time by appropriately launching
   tensorboard with `tensorboard --logdir=/path/to/tb_log_exp_name`.

   If no parameters are provided, the default folder in which tensorboard
   log files are placed is "./runs/".
   .. note::
       We rely on PyTorch implementation of Tensorboard. If you
       don't have Tensorflow installed in your environment,
       tensorboard will tell you that it is running with reduced
       feature set. This should not impact on the logger performance.

   Creates an instance of the `TensorboardLogger`.

   :param tb_log_dir: path to the directory where tensorboard log file
       will be stored. Default to "./tb_data".
   :param filename_suffix: string suffix to append at the end of
       tensorboard log file. Default ''.

   .. method:: log_metric(self, metric_value: MetricValue, callback: str)

      This abstract method will has to be implemented by child classes.
      This method will be invoked on each callback.
      The `callback` parameter describes the callback from which the metric
      value is coming from.

      :param metric_value: The value to be logged.
      :param callback: The name of the callback (event) from which the
          metric value was obtained.
      :return: None



.. py:class:: WandBLogger(project_name: str = 'Avalanche', run_name: str = 'Avalanche Test', params: dict = None)

   Bases: :class:`avalanche.logging.StrategyLogger`

   The `WandBLogger` provides an easy integration with
   Weights & Biases logging. Each monitored metric is automatically
   logged to a dedicated Weights & Biases project dashboard.

   Creates an instance of the `WandBLogger`.

   :param project_name: Name of the W&B project.:
   :param run_name: Name of the W&B run.:
   :param params: All arguments for wandb.init() function call. 
    Visit https://docs.wandb.ai/ref/python/init to learn about all 
    wand.init() parameters.:

   .. method:: import_wandb(self)


   .. method:: args_parse(self)


   .. method:: before_run(self)


   .. method:: log_metric(self, metric_value: MetricValue, callback: str)

      This abstract method will has to be implemented by child classes.
      This method will be invoked on each callback.
      The `callback` parameter describes the callback from which the metric
      value is coming from.

      :param metric_value: The value to be logged.
      :param callback: The name of the callback (event) from which the
          metric value was obtained.
      :return: None



.. py:class:: TextLogger(file=sys.stdout)

   Bases: :class:`avalanche.logging.StrategyLogger`

   The `TextLogger` class provides logging facilities
   printed to a user specified file. The logger writes
   metric results after each training epoch, evaluation
   experience and at the end of the entire evaluation stream.

   .. note::
       To avoid an excessive amount of printed lines,
       this logger will **not** print results after
       each iteration. If the user is monitoring
       metrics which emit results after each minibatch
       (e.g., `MinibatchAccuracy`), only the last recorded
       value of such metrics will be reported at the end
       of the epoch.

   .. note::
       Since this logger works on the standard output,
       metrics producing images or more complex visualizations
       will be converted to a textual format suitable for
       console printing. You may want to add more loggers
       to your `EvaluationPlugin` to better support
       different formats.

   Creates an instance of `TextLogger` class.

   :param file: destination file to which print metrics
       (default=sys.stdout).

   .. method:: log_metric(self, metric_value: MetricValue, callback: str) -> None

      This abstract method will has to be implemented by child classes.
      This method will be invoked on each callback.
      The `callback` parameter describes the callback from which the metric
      value is coming from.

      :param metric_value: The value to be logged.
      :param callback: The name of the callback (event) from which the
          metric value was obtained.
      :return: None


   .. method:: _val_to_str(self, m_val)


   .. method:: print_current_metrics(self)


   .. method:: before_training_exp(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `train_exp` by the `BaseStrategy`. 


   .. method:: before_eval_exp(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `eval_exp` by the `BaseStrategy`. 


   .. method:: after_training_epoch(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `train_epoch` by the `BaseStrategy`. 


   .. method:: after_eval_exp(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `eval_exp` by the `BaseStrategy`. 


   .. method:: before_training(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `train` by the `BaseStrategy`. 


   .. method:: before_eval(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called before `eval` by the `BaseStrategy`. 


   .. method:: after_training(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `train` by the `BaseStrategy`. 


   .. method:: after_eval(self, strategy: BaseStrategy, metric_values: List['MetricValue'], **kwargs)

      Called after `eval` by the `BaseStrategy`. 


   .. method:: _on_exp_start(self, strategy: BaseStrategy)



